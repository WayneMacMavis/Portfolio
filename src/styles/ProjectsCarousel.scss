:root {
  --brand-accent: #5e75f7ea;
  --brand-color: #ff0000ea;
  --code-green: #2ecc71;
  --figma-purple: #9b59b6;
  --brand-rgb: 94, 117, 247;
  --brand-color-1: #ffffff;
  --text-color: #e7e7ea;
  --button-color: #9aa3ff;
}

/* ===== Carousel Layout ===== */
.three-card-carousel {
  position: relative;
  width: 100%;
  height: 650px; /* fixed for 3D math */
  display: flex;
  align-items: center;
  justify-content: center;
  perspective: var(--tilt-perspective);

  /* Navigation Arrows */
  .nav {
    background: none;
    border: none;
    font-size: 5rem;
    color: var(--text-color);
    cursor: pointer;
    z-index: 10;
    padding: 0 1rem;
    line-height: 1;
    transition: color 0.25s ease;
    &:hover { color: var(--button-color); }
  }

  /* Stage */
  .carousel-stage {
    position: relative;
    width: min(100%, 1400px);
    height: 100%;
    display: grid;
    place-items: center;
    transform-style: preserve-3d;

    /* Added for swipe: prevent native image drag/select and show drag cursor */
    cursor: grab;
    user-select: none;
    -webkit-user-select: none;
    -webkit-user-drag: none;
    touch-action: pan-y; /* allow vertical scroll while we handle horizontal drag */
    &:active { cursor: grabbing; }
  }

  /* ===== Card Base ===== */
  .card {
    position: absolute;
    width: 700px; /* fixed for 3D math */
    height: 420px; /* fixed for 3D math */
    border-radius: 1rem;
    overflow: visible;
    background: transparent;
    will-change: transform, opacity;
    user-select: none;
    transform-style: preserve-3d;
    transform-origin: center;
    transition: box-shadow 0.3s ease;

    &.center { pointer-events: auto; }
    &.left, &.right { pointer-events: none; filter: blur(0.5px); }

    /* ===== Tilt Container ===== */
    .card-tilt {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      will-change: transform;
      border-radius: 1rem;
      overflow: hidden;
      background: #0f0f10;
      box-shadow:
        0 30px 60px rgba(0, 0, 0, 0.55),
        0 0 0 1px rgba(255, 255, 255, 0.04) inset;

      .card.center &:hover {
        box-shadow:
          0 40px 80px rgba(0, 0, 0, 0.6),
          0 0 0 1px rgba(255, 255, 255, 0.05) inset;
      }

      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        transform: translateZ(0);

        /* Added for swipe: stop native image drag from stealing gesture */
        pointer-events: none;
        -webkit-user-drag: none;
        user-select: none;
      }

      /* ===== Light Sweep ===== */
      .light-sweep {
        position: absolute;
        top: 0; left: -75%;
        width: 50%; height: 100%;
        background: linear-gradient(
          var(--sweep-angle, 75deg),
          rgba(255, 255, 255, 0) 0%,
          rgba(255, 255, 255, 0.25) 50%,
          rgba(255, 255, 255, 0) 100%
        );
        transform: skewX(-20deg);
        animation: sweep 1s ease forwards;
        animation-delay: 0.15s;
        pointer-events: none;
        z-index: 2;
        mix-blend-mode: screen;
      }

      /* ===== Side Rims ===== */
      .rim {
        position: absolute;
        top: 0; bottom: 0;
        width: 84px;
        pointer-events: none;
        z-index: 2;
        mix-blend-mode: screen;
      }
      .rim-right {
        right: 0;
        background: linear-gradient(
          to left,
          rgba(var(--brand-rgb), 0.35),
          rgba(var(--brand-rgb), 0)
        );
      }
      .rim-left {
        left: 0;
        background: linear-gradient(
          to right,
          rgba(var(--brand-rgb), 0.35),
          rgba(var(--brand-rgb), 0)
        );
      }

      /* ===== Title ===== */
      .title {
        position: absolute;
        left: 20px; bottom: 70px;
        margin: 0;
        color: #fff;
        font-size: 1.3rem;
        font-weight: 600;
        z-index: 3;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.6);
        pointer-events: none;
      }

      /* ===== Buttons ===== */
      .buttons {
        position: absolute;
        left: 20px; bottom: 20px;
        display: flex;
        gap: 0.5rem;
        z-index: 3;

        a {
          width: 44px; height: 44px;
          border-radius: 10px;
          display: grid;
          place-items: center;
          font-size: 1.2rem;
          color: #fff;
          box-shadow: 0 8px 18px rgba(0, 0, 0, 0.35);
          transition: transform 0.18s ease, background 0.25s ease;
          &:hover { transform: translateY(-2px) scale(1.06); }
          &:active { transform: translateY(0) scale(0.98); }
        }

        /* Full button backgrounds */
        a.btn-live   { background-color: var(--brand-color); }
        a.btn-code   { background-color: var(--code-green); }
        a.btn-figma  { background-color: var(--figma-purple); }

        /* Tooltip labels */
        .btn-live .btn-label  { background-color: var(--brand-color); }
        .btn-code .btn-label  { background-color: var(--code-green); }
        .btn-figma .btn-label { background-color: var(--figma-purple); }

        .btn-label {
          position: absolute;
          bottom: 110%; left: 50%;
          transform: translateX(-50%) translateY(4px);
          color: #fff;
          font-size: 0.75rem;
          font-weight: 500;
          padding: 4px 8px;
          border-radius: 6px;
          white-space: nowrap;
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.25s ease, transform 0.25s ease;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
        }
        a:hover .btn-label {
          opacity: 1;
          transform: translateX(-50%) translateY(0);
        }
      }
    }
  }

  @keyframes sweep {
    0% { left: -75%; }
    100% { left: 125%; }
  }
}

/* Optional: scale down whole carousel on small screens without breaking 3D math */
@media (max-width: 1024px) {
  .three-card-carousel {
    transform: scale(0.85);
    transform-origin: top center;
  }
}
@media (max-width: 768px) {
  .three-card-carousel {
    transform: scale(0.75);
  }
}
@media (max-width: 480px) {
  .three-card-carousel {
    transform: scale(0.65);
  }
}
